{"version":3,"sources":["../../src/routes/taskController.js"],"names":["router","get","authenticationMiddleware","req","res","next","user","locals","taskModel","find","userId","_id","tasks","status","message","json","post","newTask","save","task","tags","put","id","params","body","updateOne","send","delete","deleteOne"],"mappings":"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","sourcesContent":["import { Router } from 'express';\r\n\r\nimport { taskModel } from '../model/task';\r\nimport parameterMiddleware from '../middlewares/parameterMiddleware';\r\nimport authenticationMiddleware from '../middlewares/authenticationMiddleware';\r\n\r\nconst router = Router();\r\n\r\nrouter.get('/', authenticationMiddleware, async (req, res, next) => {\r\n    try {\r\n        let { user } = res.locals;\r\n\r\n\r\n        let tasks = await taskModel.find(\r\n            { userId: user._id },\r\n            '_id title text tags dueDate'\r\n        );\r\n        if (tasks === null) {\r\n            throw { status: 404, message: 'no tasks found' };\r\n        }\r\n\r\n        return res.json(tasks);\r\n    } catch (ex) {\r\n        next(ex);\r\n    }\r\n});\r\n\r\nrouter.post('/', authenticationMiddleware, async (req, res, next) => {\r\n    try {\r\n        let { user } = res.locals;\r\n\r\n        let newTask = new taskModel({\r\n            userId: user._id\r\n        });\r\n\r\n        await newTask.save();\r\n\r\n        return res\r\n            .status(201)\r\n            .json({ task: { _id: newTask._id, tags: newTask.tags } });\r\n    } catch (ex) {\r\n        next(ex);\r\n    }\r\n});\r\n\r\nrouter.put(\r\n    '/:id',\r\n    authenticationMiddleware,\r\n    parameterMiddleware(['task']),\r\n    async (req, res, next) => {\r\n        try {\r\n            let { id } = req.params;\r\n            let { task } = req.body;\r\n            let { user } = res.locals;\r\n\r\n            await taskModel.updateOne({ _id: id, userId: user._id }, task);\r\n\r\n            return res.status(200).send('Task updated');\r\n        } catch (ex) {\r\n            next(ex);\r\n        }\r\n    }\r\n);\r\n\r\nrouter.delete('/:id', authenticationMiddleware, async (req, res, next) => {\r\n    try {\r\n        let { id } = req.params;\r\n        let { user } = res.locals;\r\n\r\n        await taskModel.deleteOne({ _id: id, userId: user._id });\r\n\r\n        return res.status(200).send('Task deleted');\r\n    } catch (ex) {\r\n        next(ex);\r\n    }\r\n});\r\n\r\nexport default router;\r\n"],"file":"taskController.js"}