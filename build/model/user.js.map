{"version":3,"sources":["../../src/model/user.js"],"names":["Schema","mongoose","userSchema","username","type","String","required","passwordHash","methods","hashPassword","plaintext","bcrypt","hash","saltRounds","comparePassword","compare","statics","isPasswordValid","passwordRules","forEach","rule","RegExp","test","userModel","model"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;;;;;;;AAEA,IAAMA,MAAM,GAAGC,kBAASD,MAAxB;AAEA,IAAIE,UAAU,GAAG,IAAIF,MAAJ,CAAW;AACxBG,EAAAA,QAAQ,EAAE;AACNC,IAAAA,IAAI,EAAEC,MADA;AAENC,IAAAA,QAAQ,EAAE;AAFJ,GADc;AAKxBC,EAAAA,YAAY,EAAE;AACVH,IAAAA,IAAI,EAAEC,MADI;AAEVC,IAAAA,QAAQ,EAAE;AAFA;AALU,CAAX,CAAjB;;;AAWAJ,UAAU,CAACM,OAAX,CAAmBC,YAAnB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAkC,iBAAeC,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACbC,kBAAOC,IAAP,CAAYF,SAAZ,EAAuBG,kBAAvB,CADa;;AAAA;AAC1BD,YAAAA,IAD0B;AAE9B,iBAAKL,YAAL,GAAoBK,IAApB;;AAF8B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAlC;;AAAA;AAAA;AAAA;AAAA;;AAKAV,UAAU,CAACM,OAAX,CAAmBM,eAAnB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAqC,kBAAeJ,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACpBC,kBAAOI,OAAP,CAAeL,SAAf,EAA0B,KAAKH,YAA/B,CADoB;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAArC;;AAAA;AAAA;AAAA;AAAA;;AAIAL,UAAU,CAACc,OAAX,CAAmBC,eAAnB,GAAqC,UAAAP,SAAS,EAAI;AAC9CQ,uBAAcC,OAAd,CAAsB,UAAAC,IAAI,EAAI;AAC1B,QAAI,CAAC,IAAIC,MAAJ,CAAWD,IAAX,EAAiBE,IAAjB,CAAsBZ,SAAtB,CAAL,EAAuC;AACnC,aAAO,KAAP;AACH;;AACD,WAAO,IAAP;AACH,GALD;AAMH,CAPD;;AASA,IAAIa,SAAS,GAAGtB,kBAASuB,KAAT,CAAe,MAAf,EAAuBtB,UAAvB,CAAhB","sourcesContent":["import mongoose from 'mongoose';\r\nimport bcrypt from 'bcryptjs';\r\nimport { saltRounds } from '../config';\r\nimport { passwordRules } from '../utils';\r\nimport '@babel/polyfill';\r\n\r\nconst Schema = mongoose.Schema;\r\n\r\nlet userSchema = new Schema({\r\n    username: {\r\n        type: String,\r\n        required: true\r\n    },\r\n    passwordHash: {\r\n        type: String,\r\n        required: true\r\n    }\r\n});\r\n\r\nuserSchema.methods.hashPassword = async function(plaintext) {\r\n    let hash = await bcrypt.hash(plaintext, saltRounds);\r\n    this.passwordHash = hash;\r\n};\r\n\r\nuserSchema.methods.comparePassword = async function(plaintext) {\r\n    return await bcrypt.compare(plaintext, this.passwordHash);\r\n};\r\n\r\nuserSchema.statics.isPasswordValid = plaintext => {\r\n    passwordRules.forEach(rule => {\r\n        if (!new RegExp(rule).test(plaintext)) {\r\n            return false;\r\n        }\r\n        return true;\r\n    });\r\n};\r\n\r\nlet userModel = mongoose.model('User', userSchema);\r\n\r\nexport { userSchema, userModel };\r\n"],"file":"user.js"}